(()=>{!function(){var e={},t="%}",n=new RegExp(`((^|${t})[^\t]*)'`,"g"),o=new RegExp(`\t=(.*?)${t}`,"g");this.tmpl=function i(a,r){var l=/^[-a-zA-Z0-9]+$/.test(a)?e[a]=e[a]||i(document.getElementById(a).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("{%").join("\t").replace(n,"$1\r").replace(o,"',$1,'").split("\t").join("');").split(t).join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return r?l(r):l}}();var e,t=(e=0,function(t,n){clearTimeout(e),e=setTimeout(t,n)});if(void 0===n)var n={};function o(e,n,o,i="top-toast"){$("#"+i+" .toast-body .message").html(o),$("#"+i+" .toast-header").removeClass(["bg-danger","bg-success"]).addClass(e).text(n),$("#"+i+" .toast").addClass("show"),t((()=>$("#"+i+" .toast").removeClass("show")),5e3)}function a(e,t,o){!function e(t,i){if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++)if(child=t.childNodes[a],3!=child.nodeType&&8!=child.nodeType)if(child&&null!=child.attributes&&(matchChild=n.Components.matchNode(child))){if(Array.isArray(o)&&-1==o.indexOf(matchChild.type)){element=e(child,i);continue}element={name:matchChild.name,image:matchChild.image,type:matchChild.type,node:child,children:[]},element.children=[],i.push(element),element=e(child,element.children)}else element=e(child,i);return!1}(e,t)}function r(e){var t=1,o=Math.floor(100*Math.random());return function e(a){var r=$("<ol></ol>");for(i in t++,a){var l=a[i],s=o+"-"+t+"-"+i;if(a[i].children.length>0)(d=$('<li data-component="'+l.name+'">\t\t\t\t\t\t\t\t<label for="id'+s+'" style="background-image:url('+n.imgBaseUrl+l.image+')"><span>'+l.name+'</span></label>\t\t\t\t\t\t\t\t<input type="checkbox" id="id'+s+'">\t\t\t\t\t\t\t</li>')).append(e(l.children));else var d=$('<li data-component="'+l.name+'" class="file">\t\t\t\t\t\t\t<label for="id'+s+'" style="background-image:url('+n.imgBaseUrl+l.image+')"><span>'+l.name+'</span></label>\t\t\t\t\t\t\t<input type="checkbox" id="id'+s+'">\t\t\t\t\t\t\t</li>');d.data("node",l.node),r.append(d)}return r}(e)}n.defaultComponent="_base",n.preservePropertySections=!0,n.dragIcon="icon",n.dragElementStyle="background:limegreen;width:100%;height:3px;border:1px solid limegreen;box-shadow:0px 0px 2px 1px rgba(0,0,0,0.14);overflow:hidden;",n.dragHtml='<div style="'+n.dragElementStyle+'"></div>',n.baseUrl=document.currentScript?document.currentScript.src.replace(/[^\/]*?\.js$/,""):"",n.imgBaseUrl=n.baseUrl,n.ComponentsGroup={},n.SectionsGroup={},n.BlocksGroup={},n.Components={_components:{},_nodesLookup:{},_attributesLookup:{},_classesLookup:{},_classesRegexLookup:{},componentPropertiesElement:"#right-panel .component-properties",componentPropertiesDefaultSection:"content",get:function(e){return this._components[e]},updateProperty:function(e,t,n){let o=this._components[e].properties;for(property in o)if(t==o[property].key)return this._components[e].properties[property]=Object.assign(o[property],n)},getProperty:function(e,t){let n=this._components[e]?this._components[e].properties:[];for(property in n)if(t==n[property].key)return n[property]},add:function(e,t){if(t.type=e,this._components[e]=t,t.nodes)for(var n in t.nodes)this._nodesLookup[t.nodes[n]]=t;if(t.attributes)if(t.attributes.constructor===Array)for(var n in t.attributes)this._attributesLookup[t.attributes[n]]=t;else for(var n in t.attributes)void 0===this._attributesLookup[n]&&(this._attributesLookup[n]={}),void 0===this._attributesLookup[n][t.attributes[n]]&&(this._attributesLookup[n][t.attributes[n]]={}),this._attributesLookup[n][t.attributes[n]]=t;if(t.classes)for(var n in t.classes)this._classesLookup[t.classes[n]]=t;if(t.classesRegex)for(var n in t.classesRegex)this._classesRegexLookup[t.classesRegex[n]]=t},extend:function(e,t,n){var o=n;(inheritData=this._components[e])&&((o=$.extend(!0,{},inheritData,n)).properties=$.merge($.merge([],inheritData.properties?inheritData.properties:[]),n.properties?n.properties:[])),o.properties.sort((function(e,t){return void 0===e.sort&&(e.sort=0),void 0===t.sort&&(t.sort=0),e.sort<t.sort?-1:e.sort>t.sort?1:0})),this.add(t,o)},matchNode:function(e){var t={};if(!e||!e.tagName)return!1;if(e.attributes&&e.attributes.length){for(var n in e.attributes)if(e.attributes[n]&&(attr=e.attributes[n].name,value=e.attributes[n].value,attr in this._attributesLookup)){if(void 0!==(t=this._attributesLookup[attr]).name)return t;if(value in t)return t[value]}for(var n in e.attributes)if(attr=e.attributes[n].name,value=e.attributes[n].value,"class"==attr){for(j in classes=value.split(" "),classes)if(classes[j]in this._classesLookup)return this._classesLookup[classes[j]];for(regex in this._classesRegexLookup)if(regexObj=new RegExp(regex),regexObj.exec(value))return this._classesRegexLookup[regex]}}return tagName=e.tagName.toLowerCase(),tagName in this._nodesLookup&&this._nodesLookup[tagName]},render:function(e,t=!1){var o=this._components[e];if(o){t||(t=this.componentPropertiesElement),$(t);var i=this.componentPropertiesDefaultSection,a={};$(t+" .tab-pane").each((function(){var e=this.dataset.section;a[e]=$(this),$('.section[data-section!="default"]',this).remove(),$('label[for!="header_default"]',this).remove(),$('input[id!="header_default"]',this).remove()}));var r=a[i].find('.section[data-section="default"]');n.preservePropertySections&&r.length||(a[i].html("").append(tmpl("vvveb-input-sectioninput",{key:"default",header:o.name})),r=a[i].find(".section")),a[i].find('[data-header="default"] span').html(o.name),r.html(""),o.beforeInit&&o.beforeInit(n.Builder.selectedEl.get(0));var l=function(e,t){return t.input.on("propertyChange",(function(o,i,a,r){var l=selectedElement=n.Builder.selectedEl;if(t.child&&(l=l.find(t.child)),t.parent&&(l=l.parent(t.parent)),t.onChange){let n=t.onChange(l,i,a,e,r);"object"==typeof n?l=n:i=n}return t.htmlAttr&&(oldValue=l.attr(t.htmlAttr),"class"==t.htmlAttr&&t.validValues?(l.removeClass(t.validValues.join(" ")),l=l.addClass(i)):"style"==t.htmlAttr?(oldStyle=$("#vvvebjs-styles",window.FrameDocument).html(),l=n.StyleManager.setStyle(l,t.key,i)):l="innerHTML"==t.htmlAttr?n.ContentManager.setHtml(l,i):"innerText"==t.htmlAttr?n.ContentManager.setText(l,i):i?l.attr(t.htmlAttr,i):l.removeAttr(t.htmlAttr),"style"==t.htmlAttr?(mutation={type:"style",target:l.get(0),attributeName:t.htmlAttr,oldValue:oldStyle,newValue:$("#vvvebjs-styles",window.FrameDocument).html()},n.Undo.addMutation(mutation)):n.Undo.addMutation({type:"attributes",target:l.get(0),attributeName:t.htmlAttr,oldValue,newValue:l.attr(t.htmlAttr)})),e.onChange&&(l=e.onChange(l,t,i,a)),t.child||t.parent?n.Builder.selectNode(selectedElement):n.Builder.selectNode(l),l}))},s=n.Builder.selectedEl;for(var d in o.properties){var c=o.properties[d],u=s;let e;if(c.beforeInit&&c.beforeInit(u.get(0)),c.child&&(u=u.find(c.child)),c.parent&&(u=u.parent(c.parent)),c.data?c.data.key=c.key:c.data={key:c.key},void 0===c.group&&(c.group=null),c.input=c.inputtype.init(c.data,u),c.init)c.inputtype.setValue(c.init(u.get(0)));else if(c.htmlAttr){if(e="style"==c.htmlAttr?n.StyleManager.getStyle(u,c.key):"innerHTML"==c.htmlAttr?n.ContentManager.getHtml(u):"innerText"==c.htmlAttr?n.ContentManager.getText(u):u.attr(c.htmlAttr),e&&"class"==c.htmlAttr&&c.validValues){let t=e.split(" ").filter((function(e){return-1!=c.validValues.indexOf(e)}));e=t&&t.length?t[0]:""}!e&&c.defaultValue&&(e=c.defaultValue),c.inputtype.setValue(e)}else!e&&c.defaultValue&&(e=c.defaultValue),c.inputtype.setValue(e);l(o,c);var g=i;if(c.section&&(g=c.section),c.inputtype==SectionInput)r=a[g].find('.section[data-section="'+c.key+'"]'),n.preservePropertySections&&r.length?r.html(""):(a[g].append(c.input),r=a[g].find('.section[data-section="'+c.key+'"]'));else{var p=$(tmpl("vvveb-property",c));p.find(".input").append(c.input),r.append(p)}c.inputtype.afterInit&&c.inputtype.afterInit(c.input),c.afterInit&&c.afterInit(u.get(0),c.input)}o.init&&o.init(n.Builder.selectedEl.get(0))}}},n.Blocks={_blocks:{},get:function(e){return this._blocks[e]},add:function(e,t){t.type=e,this._blocks[e]=t}},n.Sections={_sections:{},get:function(e){return this._sections[e]},add:function(e,t){t.type=e,this._sections[e]=t}},n.WysiwygEditor={isActive:!1,oldValue:"",doc:!1,editorSetStyle:function(e,t={},o=!1){let i,a=n.Builder.iframe.contentWindow,r=a.getSelection(),l=this.element;if(e||(e="span"),r.rangeCount>0&&(r.baseNode&&null==r.baseNode.nextSibling&&null==r.baseNode.previousSibling&&0==r.anchorOffset&&r.focusOffset==r.baseNode.length||r.anchorOffset==r.focusOffset?l=r.baseNode.parentNode:(l=document.createElement(e),i=r.getRangeAt(0),i.surroundContents(l),i.selectNodeContents(l.childNodes[0],0))),l&&t)for(name in t)!t[name]||o&&l.style.getPropertyValue(name)?l.style.removeProperty(name):l.style.setProperty(name,t[name]);if("SPAN"==l.tagName&&0==l.style.length&&l.attributes.length<=1){let e=a.document.createTextNode(l.innerText);l.replaceWith(e),l=e,i=a.document.createRange(),i.selectNodeContents(l),r.removeAllRanges(),r.addRange(i)}return"a"==e&&(n.Builder.selectNode(l),n.Builder.loadNodeComponent(l)),l},init:function(e){this.doc=e;let t=this;$("#bold-btn").on("click",(function(e){return t.editorSetStyle(!1,{"font-weight":"bold"},!0),e.preventDefault(),!1})),$("#italic-btn").on("click",(function(e){return t.editorSetStyle(!1,{"font-style":"italic"},!0),e.preventDefault(),!1})),$("#underline-btn").on("click",(function(e){return t.editorSetStyle(!1,{"text-decoration":"underline"},!0),e.preventDefault(),!1})),$("#strike-btn").on("click",(function(e){return t.editorSetStyle(!1,{"text-decoration":"line-through"},!0),e.preventDefault(),!1})),$("#link-btn").on("click",(function(e){return t.editorSetStyle("a"),e.preventDefault(),!1})),$("#fore-color").on("change",(function(e){return t.editorSetStyle(!1,{color:this.value}),e.preventDefault(),!1})),$("#back-color").on("change",(function(e){return t.editorSetStyle(!1,{"background-color":this.value}),e.preventDefault(),!1})),$("#font-size").on("change",(function(e){return t.editorSetStyle(!1,{"font-size":this.value}),e.preventDefault(),!1}));let o="<option value=''> - Font size - </option>";for(i=1;i<=128;i++)o+="<option value='"+i+"px'>"+i+"</option>";$("#font-size").html(o),$("#font-family").on("change",(function(e){let o=this.options[this.selectedIndex],i=t.editorSetStyle(!1,{"font-family":this.value});return n.FontsManager.addFont(o.dataset.provider,this.value,i),e.preventDefault(),!1})),$("#justify-btn a").on("click",(function(e){return t.editorSetStyle(!1,{"text-align":this.dataset.value}),e.preventDefault(),!1}))},undo:function(e){this.doc.execCommand("undo",!1,null)},redo:function(e){this.doc.execCommand("redo",!1,null)},edit:function(e){e.attr({contenteditable:!0,spellcheckker:!1}),$("#wysiwyg-editor").show(),this.element=e,this.isActive=!0,this.oldValue=e.html(),$("#font-familly").val(getComputedStyle(e[0])["font-family"]),e.focus()},destroy:function(e){e.removeAttr("contenteditable spellcheckker"),$("#wysiwyg-editor").hide(),this.isActive=!1,node=this.element.get(0),n.Undo.addMutation({type:"characterData",target:node,oldValue:this.oldValue,newValue:node.innerHTML})}},n.Builder={component:{},dragMoveMutation:!1,isPreview:!1,runJsOnSetHtml:!1,designerMode:!1,highlightEnabled:!1,selectPadding:0,leftPanelWidth:275,ignoreClasses:["clearfix"],init:function(e,t){var n=this;n.loadControlGroups(),n.loadBlockGroups(),n.loadSectionGroups(),n.selectedEl=null,n.highlightEl=null,n.initCallback=t,n.documentFrame=$("#iframe-wrapper > iframe"),n.canvas=$("#canvas"),n._loadIframe(e),n._initDragdrop(),n._initBox(),n.dragElement=null,n.highlightEnabled=!0,n.leftPanelWidth=$("#left-panel").width(),n.adjustListsHeight(),$(window).on("scroll resize",(function(e){n.adjustListsHeight()}))},loadControlGroups:function(){var e=$(".components-list");e.empty();var t={},o={},a=0;e.each((function(){var e=$(this),r=this.dataset.type;for(group in a++,n.ComponentsGroup){e.append(`<li class="header" data-section="${group}"  data-search="">\n\t\t\t\t\t<label class="header" for="${r}_comphead_${group}${a}">\n\t\t\t\t\t\t${group}<div class="header-arrow"></div>\n\t\t\t\t\t</label>\n\t\t\t\t\t<input class="header_check" type="checkbox" checked="true" id="${r}_comphead_${group}${a}">\n\t\t\t\t\t<ol></ol>\n\t\t\t\t</li>`);var l=e.find('li[data-section="'+group+'"]  ol');for(i in components=n.ComponentsGroup[group],components)componentType=components[i],(o=n.Components.get(componentType))&&(t=$(`<li data-section="${group}" data-drag-type="component" data-type="${componentType}" data-search="${o.name.toLowerCase()}">\n\t\t\t\t\t\t\t<span>${o.name}</span>\n\t\t\t\t\t\t</li>`),o.image&&t.css({backgroundImage:"url("+n.imgBaseUrl+o.image+")",backgroundRepeat:"no-repeat"}),l.append(t))}}))},loadSectionGroups:function(){console.log("loadSectionGroups sections",n.Sections);var e=$(".sections-list");e.empty();var t={};e.each((function(){var e=$(this),o=this.dataset.type;for(group in n.SectionsGroup){e.append(`<li class="header" data-section="${group}"  data-search="">\n\t\t\t\t\t<label class="header" for="${o}_sectionhead_${group}">\n\t\t\t\t\t\t${group}<div class="header-arrow"></div>\n\t\t\t\t\t</label>\n\t\t\t\t\t<input class="header_check" type="checkbox" checked="true" id="${o}_sectionhead_${group}">\n\t\t\t\t\t<ol></ol>\n\t\t\t\t</li>`);var a=e.find('li[data-section="'+group+'"]  ol');for(i in sections=n.SectionsGroup[group],sections)if(sectionType=sections[i],section=n.Sections.get(sectionType),section){if(t=$(`<li data-section="${group}" data-type="${sectionType}" data-search="${section.name.toLowerCase()}">\n\t\t\t\t\t\t\t\t\t<span class="name">${section.name}</span>\n\t\t\t\t\t\t\t\t\t<div class="add-section-btn" title="Add section"><i class="la la-plus"></i></div>\n\t\t\t\t\t\t\t\t\t<img class="preview" src="" loading="lazy">\n\t\t\t\t\t\t\t\t</li>`),section.image){var r=(-1==section.image.indexOf("/")?n.imgBaseUrl:"")+section.image;t.css({}).find("img").attr("src",r)}a.append(t)}}}))},loadBlockGroups:function(){var e=$(".blocks-list");e.empty();var t={};e.each((function(){var e=$(this),o=this.dataset.type;for(group in n.BlocksGroup){e.append(`<li class="header" data-section="${group}"  data-search="">\n\t\t\t\t\t<label class="header" for="${o}_blockhead_${group}">\n\t\t\t\t\t\t${group}<div class="header-arrow"></div>\n\t\t\t\t\t</label>\n\t\t\t\t\t<input class="header_check" type="checkbox" checked="true" id="${o}_blockhead_${group}">\n\t\t\t\t\t<ol></ol>\n\t\t\t\t</li>`);var a=e.find('li[data-section="'+group+'"]  ol');for(i in blocks=n.BlocksGroup[group],blocks)if(blockType=blocks[i],block=n.Blocks.get(blockType),block){if(t=$(`<li data-section="${group}" data-drag-type="block" data-type="${blockType}" data-search="${block.name.toLowerCase()}">\n\t\t\t\t\t\t\t\t\t<span class="name">${block.name}</span>\n\t\t\t\t\t\t\t\t\t<img class="preview" src="" loading="lazy">\n\t\t\t\t\t\t\t\t</li>`),block.image){var r=(-1==block.image.indexOf("/")?n.imgBaseUrl:"")+block.image;t.css({}).find("img").attr("src",r)}a.append(t)}}}))},adjustListsHeight:function(){let e=$(".drag-elements-sidepane > div:not(.block-preview)"),t=$(".component-properties > .tab-content"),n=$(window).height(),o=0;function i(e){e.each((function(e,t){t.style.height="",o=Math.max(0,t.getBoundingClientRect().top),t.style.height=n-o+"px"}))}i(e),i(t)},loadUrl:function(e,t){$("#select-box").hide(),this.initCallback=t,n.Builder.iframe.src!=e&&(n.Builder.iframe.src=e)},_loadIframe:function(e){var t=this;return t.iframe=this.documentFrame.get(0),t.iframe.src=e,this.documentFrame.on("load",(function(){window.FrameWindow=t.iframe.contentWindow,window.FrameDocument=t.iframe.contentWindow.document,$("#add-section-box");var e=$("#highlight-box").hide();return $(window.FrameWindow).on("beforeunload",(function(e){if(n.Undo.undoIndex>=0){var t="You have unsaved changes";return e.returnValue=t,t}})),$(window.FrameWindow).on("unload",(function(e){$(".loading-message").addClass("active"),n.Undo.reset()})),$(window.FrameDocument).on("click","a",(function(e){if(n.WysiwygEditor.isActive)return e.preventDefault(),!1})),$(window.FrameWindow).on("scroll resize",(function(n){if(t.selectedEl){var o=t.selectedEl.offset();$("#select-box").css({top:o.top-t.frameDoc.scrollTop()-t.selectPadding,left:o.left-t.frameDoc.scrollLeft()-t.selectPadding})}t.highlightEl&&(o=t.highlightEl.offset(),e.css({top:o.top-t.frameDoc.scrollTop()-t.selectPadding,left:o.left-t.frameDoc.scrollLeft()-t.selectPadding}))})),n.WysiwygEditor.init(window.FrameDocument),n.StyleManager.init(window.FrameDocument),n.ColorPaletteManager.init(window.FrameDocument),t.initCallback&&t.initCallback(),t._frameLoaded()}))},_frameLoaded:function(){var e=n.Builder;e.frameDoc=$(window.FrameDocument),e.frameHtml=$(window.FrameDocument).find("html"),e.frameBody=$(window.FrameDocument).find("body"),e.frameHead=$(window.FrameDocument).find("head"),e.frameHead.append('<link data-vvveb-helpers href="'+n.baseUrl+'../../css/vvvebjs-editor-helpers.css" rel="stylesheet">'),e._initHighlight(),$(window).triggerHandler("vvveb.iframe.loaded",e.frameDoc),$(".loading-message").removeClass("active"),n.Builder.frameBody.on("vvveb.undo.add vvveb.undo.restore",(function(e){n.Undo.hasChanges()?$("#top-panel .save-btn").removeAttr("disabled"):$("#top-panel .save-btn").attr("disabled","true")}))},_getElementType:function(e){var t="";if(e.attributes)for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].nodeName;if(o.indexOf("data-component")>-1)return[o.replace("data-component-",""),"component"];if(o.indexOf("data-v-component-")>-1)return[o.replace("data-v-component-",""),"component"];o.indexOf("data-v-")>-1&&(t=(t?t+" - ":"")+o.replace("data-v-","")+" ")}return""!=t?[t,"attribute"]:[e.id?"#"+e.id:e.className&&"string"==typeof e.className?"."+e.className.split(" ")[0]:"",e.tagName]},loadNodeComponent:function(e){var t;data=n.Components.matchNode(e),t=data?data.type:n.defaultComponent,n.component=n.Components.get(t),n.Components.render(t)},moveNodeUp:function(e){e||(e=n.Builder.selectedEl.get(0)),oldParent=e.parentNode,oldNextSibling=e.nextSibling,next=$(e).prev(),next.length>0?next.before(e):$(e).parent().before(e),n.Builder.selectNode(e),newParent=e.parentNode,newNextSibling=e.nextSibling,n.Undo.addMutation({type:"move",target:e,oldParent,newParent,oldNextSibling,newNextSibling})},moveNodeDown:function(e){e||(e=n.Builder.selectedEl.get(0)),oldParent=e.parentNode,oldNextSibling=e.nextSibling,next=$(e).next(),next.length>0?next.after(e):$(e).parent().after(e),n.Builder.selectNode(e),newParent=e.parentNode,newNextSibling=e.nextSibling,n.Undo.addMutation({type:"move",target:e,oldParent,newParent,oldNextSibling,newNextSibling})},cloneNode:function(e){e||(e=n.Builder.selectedEl),clone=e.clone(),e.after(clone),e=clone.click(),element=clone.get(0),n.Undo.addMutation({type:"childList",target:e.parentNode,addedNodes:[element],nextSibling:e.nextSibling})},selectNode:function(e){var t=this;if(!e)return void $("#select-box").hide();t.texteditEl&&t.selectedEl.get(0)!=e&&(n.WysiwygEditor.destroy(t.texteditEl),t.selectPadding=0,$("#select-box").removeClass("text-edit").find("#select-actions").show(),t.texteditEl=null);var o=$(e);if(o){t.selectedEl=o;try{var i=o.offset();$("#select-box").css({top:i.top-t.frameDoc.scrollTop()-t.selectPadding,left:i.left-t.frameDoc.scrollLeft()-t.selectPadding,width:o.outerWidth()+2*t.selectPadding,height:o.outerHeight()+2*t.selectPadding,display:"block"}),n.Breadcrumb.loadBreadcrumb(o.get(0))}catch(e){return console.log(e),!1}}let a=this._getElementType(e);$("#highlight-name .type").html(a[0]),$("#highlight-name .name").html(a[1])},_initHighlight:function(){var e=n.Builder;e.frameBody.on("mousemove dragover touchmove",(function(t){if(1==e.highlightEnabled&&t.target&&"object"==typeof(m=t.target)&&1===m.nodeType&&"object"==typeof m.style&&"object"==typeof m.ownerDocument&&t.originalEvent){e.highlightEl=target=$(t.target);var o=target.offset(),i=target.outerHeight(),a=Math.max(i/2,5),r=target.outerWidth(),l=Math.max(r/2,5),s=t.originalEvent.x,d=t.originalEvent.y;if(e.isResize){e.initialPosition||(e.initialPosition={x:s,y:d});var c=s-e.initialPosition.x,u=d-e.initialPosition.y;switch(o=e.selectedEl.offset(),r=e.initialSize.width,i=e.initialSize.height,e.resizeHandler){case"top-left":i-=u,r-=c;break;case"top-center":i-=u;break;case"top-right":i-=u,r+=c;break;case"center-left":r-=c;break;case"center-right":r+=c;break;case"bottom-left":r-=c,i+=u;break;case"bottom-center":i+=u;break;case"bottom-right":r+=c,i+=u}"css"==e.resizeMode?e.selectedEl.css({width:r,height:i}):e.selectedEl.attr({width:r,height:i}),$("#select-box").css({top:o.top-e.frameDoc.scrollTop(),left:o.left-e.frameDoc.scrollLeft(),width:r,height:e.selectedEl.outerHeight()})}else if(e.isDragging){var g=e.highlightEl;let n=g[0].tagName.toLowerCase(),i={input:!0,textarea:!0,img:!0,svg:!0,iframe:!0,embed:!0,col:!0,area:!0,hr:!0,br:!0,wbr:!0};try{if(o.top<t.originalEvent.pageY-a||o.left<s-l?i[n]?e.dragElement.insertAfter(g):e.dragElement.appendTo(g):i[n]?e.dragElement.insertBefore(g):e.dragElement.prependTo(g),e.designerMode){var p=e.dragElement.offsetParent().offset();e.dragElement.css({position:"absolute",left:s-(p.left-e.frameDoc.scrollLeft()),top:d-(p.top-e.frameDoc.scrollTop())})}}catch(e){return console.log(e),!1}!e.designerMode&&e.iconDrag&&e.iconDrag.css({left:s+e.leftPanelWidth+10,top:d+60})}{if(n.WysiwygEditor.isActive&&e.texteditEl.get(0).contains(t.target))return!0;$("#highlight-box").css({top:o.top-e.frameDoc.scrollTop(),left:o.left-e.frameDoc.scrollLeft(),width:r,height:i,display:t.target.hasAttribute("contenteditable")?"none":"block",border:e.isDragging?"1px dashed #0d6efd":""}),i<50?$("#section-actions").addClass("outside"):$("#section-actions").removeClass("outside");let a=e._getElementType(t.target);$("#highlight-name .type").html(a[0]),$("#highlight-name .name").html(a[1])}}var m})),e.frameHtml.on("mouseup dragend touchend",(function(t){e.isResize=!1,$("#section-actions, #highlight-name, #select-box").show(),e.isDragging&&(e.isDragging=!1,n.Builder.highlightEnabled=!0,e.iconDrag&&e.iconDrag.remove(),$("#component-clone").remove(),!1===e.dragMoveMutation?((e.component.dragHtml||n.dragHtml)&&e.component&&(newElement=$(e.component.html),e.dragElement.replaceWith(newElement),e.dragElement=newElement),e.component.afterDrop&&(e.dragElement=e.component.afterDrop(e.dragElement))):(e.dragElement.replaceWith(e.selectedEl.removeClass("is-dragged")),e.dragElement=e.selectedEl),node=e.dragElement.get(0),e.selectNode(node),e.loadNodeComponent(node),$(".component-properties-tab").is(":visible")&&$(".component-properties-tab a").show().tab("show"),!1===e.dragMoveMutation?n.Undo.addMutation({type:"childList",target:node.parentNode,addedNodes:[node],nextSibling:node.nextSibling}):(e.dragMoveMutation.newParent=node.parentNode,e.dragMoveMutation.newNextSibling=node.nextSibling,n.Undo.addMutation(e.dragMoveMutation),e.dragMoveMutation=!1))})),e.frameHtml.on("dblclick",(function(t){0==n.Builder.isPreview&&(n.WysiwygEditor.isActive||(e.selectPadding=10,e.texteditEl=target=$(t.target),n.WysiwygEditor.edit(e.texteditEl),_updateSelectBox=function(t){if(e.texteditEl){var n=e.selectedEl.offset();$("#select-box").css({top:n.top-e.frameDoc.scrollTop()-e.selectPadding,left:n.left-e.frameDoc.scrollLeft()-e.selectPadding,width:e.texteditEl.outerWidth()+2*e.selectPadding,height:e.texteditEl.outerHeight()+2*e.selectPadding})}},e.texteditEl.on("blur keyup paste input",_updateSelectBox),_updateSelectBox(),$("#select-box").addClass("text-edit").find("#select-actions").hide(),$("#highlight-box").hide()))})),e.frameHtml.on("click",(function(t){if(0==n.Builder.isPreview&&t.target)return!(!n.WysiwygEditor.isActive||!e.texteditEl.get(0).contains(t.target))||($(".component-properties-tab").is(":visible")&&$(".component-properties-tab a").show().tab("show"),e.selectNode(t.target),e.loadNodeComponent(t.target),n.component.resizable?($("#select-box").addClass("resizable"),e.resizeMode=n.component.resizeMode):$("#select-box").removeClass("resizable"),$("#add-section-box").hide(),t.preventDefault(),!1)}))},_initBox:function(){var e=this;$("#drag-btn").on("mousedown",(function(t){return e.isDragging=!0,$("#section-actions, #highlight-name, #select-box").hide(),e.designerMode?e.dragElement=e.selectedEl:(e.selectedEl.css("position","").css("top","").css("left",""),e.selectedEl.addClass("is-dragged"),e.dragElement=$(n.dragHtml)),node=e.selectedEl.get(0),e.dragMoveMutation={type:"move",target:node,oldParent:node.parentNode,oldNextSibling:node.nextSibling},t.preventDefault(),!1})),$(".resize > div").on("mousedown",(function(t){return $("#section-actions, #highlight-name, #highlight-box").hide(),e.isResize=!0,e.initialSize={width:e.selectedEl.outerWidth(),height:e.selectedEl.outerHeight()},e.initialPosition=!1,e.resizeHandler=this.className,t.preventDefault(),!1})),$("#down-btn").on("click",(function(e){return $("#select-box").hide(),n.Builder.moveNodeDown(),e.preventDefault(),!1})),$("#up-btn").on("click",(function(e){return $("#select-box").hide(),n.Builder.moveNodeUp(),e.preventDefault(),!1})),$("#clone-btn").on("click",(function(e){return n.Builder.cloneNode(),e.preventDefault(),!1})),$("#parent-btn").on("click",(function(t){return node=e.selectedEl.parent().get(0),e.selectNode(node),e.loadNodeComponent(node),t.preventDefault(),!1})),$("#save-reusable-btn").on("click",(function(t){node=e.selectedEl.get(0);let o="block";"section"==node.tagName.toLowerCase()&&(o="section");let i=prompt("Enter name for new reusable "+o,"");return i&&n.Builder.saveElement(node,o,i),t.preventDefault(),!1})),$("#edit-code-btn").on("click",(function(e){let t=n.Builder.selectedEl.get(0),o=t.innerHTML;n.ModalCodeEditor.show(),n.ModalCodeEditor.setValue(o);let i=o;return $(window).one("vvveb.ModalCodeEditor.save",(function(e,o){t.innerHTML=o,node=t,n.Undo.addMutation({type:"characterData",target:node,oldValue:i,newValue:node.innerHTML})})),!1})),$("#delete-btn").on("click",(function(t){return $("#select-box").hide(),node=e.selectedEl.get(0),n.Undo.addMutation({type:"childList",target:node.parentNode,removedNodes:[node],nextSibling:node.nextSibling}),e.selectedEl.remove(),t.preventDefault(),!1}));var t=$("#add-section-box"),o={};function i(t,i=!0){var a=$(t.html);i?o.after(a):o.append(a),t.afterDrop&&(a=t.afterDrop(a)),a=a.get(0),e.selectNode(a),e.loadNodeComponent(a),n.Undo.addMutation({type:"childList",target:a.parentNode,addedNodes:[a],nextSibling:a.nextSibling})}$("#add-section-btn").on("click",(function(n){o=e.highlightEl;var i=$(o).offset(),a=i.top-e.frameDoc.scrollTop()+o.outerHeight(),r=i.left-e.frameDoc.scrollLeft()+o.outerWidth()/2-t.outerWidth()/2,l=$(window.FrameWindow).height()+e.frameDoc.scrollTop();return r<0&&(r=0),a<0&&(a=0),r+t.outerWidth()>e.frameDoc.outerWidth()&&(r=e.frameDoc.outerWidth()-t.outerWidth()),a+t.outerHeight()+e.frameDoc.scrollTop()>l&&(a-=t.outerHeight()),t.css({top:a,left:r,display:"block"}),n.preventDefault(),!1})),$("#close-section-btn").on("click",(function(e){t.hide()})),$(".components-list li ol li",t).on("click",(function(e){i(n.Components.get(this.dataset.type),"after"==$("[name='add-section-insert-mode']:checked").val()),t.hide()})),$(".blocks-list li ol li",t).on("click",(function(e){i(n.Blocks.get(this.dataset.type),"after"==$("[name='add-section-insert-mode']:checked").val()),t.hide()})),$(".sections-list li ol li",t).on("click",(function(e){i(n.Sections.get(this.dataset.type),"after"==$("[name='add-section-insert-mode']:checked").val()),t.hide()}))},_initDragdrop:function(){var e=this;e.isDragging=!1,$("body").on("mousedown touchstart",".drag-elements-sidepane ul > li > ol > li[data-drag-type]",(function(t){return $this=$(this),$("#component-clone").remove(),$("#section-actions, #highlight-name, #select-box").hide(),"component"==$this.data("drag-type")?e.component=n.Components.get($this.data("type")):"section"==$this.data("drag-type")?e.component=n.Sections.get($this.data("type")):"block"==$this.data("drag-type")&&(e.component=n.Blocks.get($this.data("type"))),e.component.dragHtml?html=e.component.dragHtml:n.dragHtml?html=n.dragHtml:html=e.component.html,e.dragElement=$(html),e.component.dragStart&&(e.dragElement=e.component.dragStart(e.dragElement)),e.isDragging=!0,"html"==n.dragIcon?e.iconDrag=$(html).attr("id","dragElement-clone").css("position","absolute"):0==e.designerMode&&(e.iconDrag=$('<img src=""/>').attr({id:"dragElement-clone",src:$this.css("background-image").replace(/^url\(['"](.+)['"]\)/,"$1")}).css({"z-index":100,position:"absolute",width:"64px",height:"64px",top:t.originalEvent.y,left:t.originalEvent.x})),$("body").append(e.iconDrag),t.preventDefault(),!1})),$("body").on("mouseup dragend touchend",(function(t){e.iconDrag&&1==e.isDragging&&(e.isDragging=!1,$("#component-clone").remove(),$("#section-actions, #highlight-name, #select-box").show(),e.iconDrag.remove(),e.dragElement&&e.dragElement.remove())})),$("body").on("mousemove dragover touchmove",(function(t){if(e.iconDrag&&1==e.isDragging){var n=t.clientX||t.originalEvent.clientX,o=t.clientY||t.originalEvent.clientY;return e.iconDrag.css({left:n-60,top:o-30}),void(elementMouseIsOver=document.elementFromPoint(n-60,o-40))}})),$(".drag-elements-sidepane ul > ol > li > li").on("mouseup dragend touchend",(function(t){e.isDragging=!1,$("#component-clone").remove(),$("#section-actions, #highlight-name, #select-box").show()}))},removeHelpers:function(e,t=!1){return e=e.replace(/<[^>]+?data-vvveb-helpers.+?>/gi,""),t||(e=e.replace(/\s*data-vvveb-\w+(=["'].*?["'])?\s*/gi,"")),e},getHtml:function(e=!0){var t=window.FrameDocument,o=null!==t.doctype,i="";return $("[contenteditable]",t).removeAttr("contenteditable"),$("[spellcheckker]",t).removeAttr("spellcheckker"),$(window).triggerHandler("vvveb.getHtml.before",t),o&&(i="<!DOCTYPE "+t.doctype.name+(t.doctype.publicId?' PUBLIC "'+t.doctype.publicId+'"':"")+(!t.doctype.publicId&&t.doctype.systemId?" SYSTEM":"")+(t.doctype.systemId?' "'+t.doctype.systemId+'"':"")+">\n"),n.FontsManager.cleanUnusedFonts(),i+=t.documentElement.outerHTML,i=this.removeHelpers(i,e),$(window).triggerHandler("vvveb.getHtml.after",t),$(window).triggerHandler("vvveb.getHtml.filter",i)||i},setHtml:function(e){function t(e,t,n=!1){return start=e.indexOf("<"+t),end=e.indexOf("</"+t),start>=0&&end>=0?n?e.slice(start,end+3+t.length):e.slice(e.indexOf(">",start)+1,end):e}this.runJsOnSetHtml?this.frameBody.html(t(e,"body")):window.FrameDocument.body.innerHTML=t(e,"body");let n=t(e,"head");window.FrameDocument.head.innerHTML!=n&&(window.FrameDocument.head.innerHTML=n)},saveElement:function(e,t,i,a){"section"==t?(n.Sections.add("reusable/"+i,{name:i,image:"img/logo-small.png",html:e.outerHTML}),void 0===n.SectionsGroup.Reusable&&(n.SectionsGroup.Reusable=[]),n.SectionsGroup.Reusable.push("reusable/"+i),n.Builder.loadSectionGroups()):(n.Blocks.add("reusable/"+i,{name:i,image:"img/logo-small.png",html:e.outerHTML}),void 0===n.BlocksGroup.Reusable&&(n.BlocksGroup.Reusable=[]),n.BlocksGroup.Reusable.push("reusable/"+i),n.Builder.loadBlockGroups());let r={type:t,name:i,html:e.outerHTML};return $.ajax({type:"POST",url:saveReusableUrl,data:r,cache:!1}).done((function(e,t){a&&a(e);let n="bg-success";e.success||"success"==t||(n="bg-danger"),o(n,"Save",e.message??e)})).fail((function(e){o("bg-danger","Error","Error saving!"),alert(e.responseText)}))},saveAjax:function(e,t,o){return e.file||(e.file=n.FileManager.getCurrentFileName()),e.startTemplateUrl||(e.html=this.getHtml()),$.ajax({type:"POST",url:o,data:e,cache:!1}).done((function(e){t&&t(e),n.Undo.reset(),$("#top-panel .save-btn").attr("disabled","true")})).fail((function(e){alert(e.responseText)}))},setDesignerMode:function(e=!1){this.designerMode=e}},n.ModalCodeEditor={modal:!1,editor:!1,init:function(e=!1,t=!1){this.modal=e||$("#codeEditorModal"),this.editor=t||$("textarea",this.modal);let n=this;$(".save-btn",this.modal).on("click",(function(e){$(window).triggerHandler("vvveb.ModalCodeEditor.save",n.getValue()),n.hide()}))},show:function(e){this.modal||this.init(),this.modal.modal("show")},hide:function(e){this.modal.modal("hide")},getValue:function(){return this.editor.val()},setValue:function(e){this.modal||this.init(),this.editor.val(e)}},n.CodeEditor={isActive:!1,oldValue:"",doc:!1,init:function(e){$("#vvveb-code-editor textarea").val(n.Builder.getHtml()),$("#vvveb-code-editor textarea").keyup((function(){t((()=>n.Builder.setHtml(this.value)),1e3)})),n.Builder.frameBody.on("vvveb.undo.add vvveb.undo.restore",(function(e){n.CodeEditor.setValue()})),n.Builder.documentFrame.on("load",(function(e){n.CodeEditor.setValue()})),this.isActive=!0},setValue:function(e){this.isActive&&$("#vvveb-code-editor textarea").val(n.Builder.getHtml())},destroy:function(e){},toggle:function(){if(1!=this.isActive)return this.isActive=!0,this.init();this.isActive=!1,this.destroy()}},n.Gui={init:function(){$("[data-vvveb-action]").each((function(){on="click",this.dataset.vvvebOn&&(on=this.dataset.vvvebOn),$(this).on(on,n.Gui[this.dataset.vvvebAction]),this.dataset.vvvebShortcut&&($(document).bind("keydown",this.dataset.vvvebShortcut,n.Gui[this.dataset.vvvebAction]),$(window.FrameDocument,window.FrameWindow).bind("keydown",this.dataset.vvvebShortcut,n.Gui[this.dataset.vvvebAction]))}));let e=localStorage.getItem("theme","dark");e&&"auto"!==e||!window.matchMedia("(prefers-color-scheme: dark)").matches||(e="dark"),e&&$("html").attr("data-bs-theme",e)},undo:function(){console.log("HI FROM UNDO"),n.WysiwygEditor.isActive?n.WysiwygEditor.undo():n.Undo.undo(),n.Builder.selectNode()},redo:function(){console.log("HI FROM REDO"),n.WysiwygEditor.isActive?n.WysiwygEditor.redo():n.Undo.redo(),n.Builder.selectNode()},save:function(){console.log("HI FROM SAVE"),$("#textarea-modal textarea").val(n.Builder.getHtml()),$("#textarea-modal").modal()},saveAjax:function(){console.log("HI FROM SAVE AJAX");let e=$(this),t=this.dataset.vvvebUrl,i=n.FileManager.getPageData("file");return $(".loading",e).toggleClass("d-none"),$(".button-text",e).toggleClass("d-none"),n.Builder.saveAjax({file:i},null,t).done((function(e,t){let n="bg-success";e.success||"success"==t?$("#top-panel .save-btn").attr("disabled","true"):n="bg-danger",o(n,"Save",e.message??e)}),t).fail((function(e,t,n){o("bg-danger","Error","Error saving!")}),t).always((function(t){$(".loading",e).toggleClass("d-none"),$(".button-text",e).toggleClass("d-none")}))},download:function(){console.log("HI FROM DOWNLOAD"),filename=/[^\/]+$/.exec(n.Builder.iframe.src)[0],uriContent="data:application/octet-stream,"+encodeURIComponent(n.Builder.getHtml());var e=document.createElement("a");"download"in e?(e.dataset.download=filename,e.href=uriContent,e.target="_blank",document.body.appendChild(e),result=e.click(),document.body.removeChild(e),e.remove()):location.href=uriContent},checkSiteStatus:async function(e,t){console.log("HI FROM CHECK SITE STATUS");let n={method:"GET",headers:{Authorization:"Bearer "+t},redirect:"follow"};console.log("siteID: ",e),console.log("netlifyToken: ",t);let o=await fetch("https://api.netlify.com/api/v1/sites/"+e,n);return 200===o.status||(console.log(o.status),!1)},redirectToNewTab:function(e){console.log("Site is: ",e),setTimeout((function(){window.open(e,"_blank")}),1e3)},waitForSiteCreation:async function(e,t){console.log("HI FROM WAIT FOR SITE CREATION");let o=await n.Gui.checkSiteStatus(e,t);for(console.log("Not ready yet");!o;)await new Promise((e=>setTimeout(e,1e3))),o=await n.Gui.checkSiteStatus(e,t),console.log("Site not ready yet")},deployToNetlify:async function(){const e="nfp_2EADXHhtLkXMYa84Ehv3eYPQUK4QDkGKc191";let t=prompt("Please enter your Netlify Site ID (leave blank to create a new site):"),o="";if(!t)try{var i={method:"POST",headers:{Authorization:"Bearer "+e},redirect:"follow"};let n=await fetch("https://api.netlify.com/api/v1/sites",i);var a=n.status;console.log("Status code:",a);let r=await n.json();o=r.url,t=r.site_id,console.log("Site URL:",o)}catch(e){return void console.error("An error occurred while creating a new site:",e)}await n.Gui.waitForSiteCreation(t,e);let r=await n.Gui.getZipFile();console.log("Zip buffer:",r);let l={method:"POST",headers:{"Content-Type":"application/zip",Authorization:"Bearer "+e},body:r,redirect:"follow"};try{let e=await fetch("https://api.netlify.com/api/v1/sites/"+t+"/deploys",l);await e.json()}catch(e){console.log("error",e)}await n.Gui.redirectToNewTab(o)},viewport:function(){document.getElementById("canvas").setAttribute("class",this.dataset.view),document.getElementById("iframe1").removeAttribute("style"),document.querySelector(".responsive-btns .active").classList.remove("active"),this.dataset.view&&this.classList.add("active")},toggleEditor:function(){console.log("HI FROM TOGGLE EDITOR"),$("#vvveb-builder").toggleClass("bottom-panel-expand"),$("#toggleEditorJsExecute").toggle(),$(".breadcrumb-navigator .breadcrumb").toggle(),n.CodeEditor.toggle()},toggleEditorJsExecute:function(){console.log("HI FROM TOGGLE EDITOR JS EXECUTE"),n.Builder.runJsOnSetHtml=this.checked},preview:function(){console.log("HI FROM PREVIEW"),1==n.Builder.isPreview?n.Builder.isPreview=!1:n.Builder.isPreview=!0,$("#iframe-layer").toggle(),$("#vvveb-builder").toggleClass("preview")},fullscreen:function(){console.log("HI FROM FULLSCREEN"),function(e){e.documentElement.requestFullScreen?e.FullScreenElement?e.exitFullScreen():e.documentElement.requestFullScreen():e.documentElement.mozRequestFullScreen?e.mozFullScreenElement?e.mozCancelFullScreen():e.documentElement.mozRequestFullScreen():e.documentElement.webkitRequestFullScreen?e.webkitFullscreenElement?e.webkitExitFullscreen():e.documentElement.webkitRequestFullScreen():e.documentElement.msRequestFullscreen&&(e.msFullScreenElement?e.msExitFullscreen():e.documentElement.msRequestFullscreen())}(document)},search:function(){console.log("HI FROM SEARCH");let e=this.value,t=$("div > ul",this.parentNode.parentNode);$("li ol li",t).each((function(){$this=$(this),$this.hide(),$this.data("search").indexOf(e)>-1&&$this.show()}))},clearSearch:function(e){console.log("HI FROM CLEAR SEARCH"),$("input",this.parentNode).val("").keyup()},expand:function(e){$('input.header_check[type="checkbox"]',this.parentNode.parentNode.parentNode).prop("checked",!0)},collapse:function(e){$('input.header_check[type="checkbox"]',this.parentNode.parentNode.parentNode).prop("checked",!1)},newPage:function(){console.log("HI FROM NEW PAGE");var e=$("#new-page-modal");e.modal("show").find("form").off("submit").submit((function(t){var o={};return $.each($(this).serializeArray(),(function(){o[this.name]=this.value})),o.file&&(o.title=o.file.replace("/","").replace(".html",""),o.name||(o.name=o.title),o.url=o.file=o.folder+"/"+o.file),t.preventDefault(),n.Builder.saveAjax(o,(function(t){o.title=o.name,"object"==typeof t&&null!==t&&Object.assign(o,t),n.FileManager.addPage(o.name,o),n.FileManager.loadPage(o.name),n.FileManager.scrollBottom(),e.modal("hide")}),this.action)}))},setDesignerMode:function(){console.log("HI FROM SET DESIGNER MODE");var e="true"==this.attributes["aria-pressed"].value;n.Builder.setDesignerMode(e)},togglePanel:function(e,t){e=$(e);var o=$("body"),i=o.css(t);let a=!1;return"0px"!==i?(e.data("layout-toggle",i),o.css(t,"0px"),e.hide(),a=!1):(i=e.data("layout-toggle"),o.css(t,""),e.show(),a=!0),n.Builder.adjustListsHeight(),a},toggleFileManager:function(){console.log("HI FROM TOGGLE FILE MANAGER"),n.Gui.togglePanel("#filemanager","--builder-filemanager-height")},toggleLeftColumn:function(){console.log("HI FROM TOGGLE LEFT COLUMN"),n.Gui.togglePanel("#left-panel","--builder-left-panel-width")},toggleRightColumn:function(e=null){console.log("HI FROM TOGGLE RIGHT COLUMN"),e=n.Gui.togglePanel("#right-panel","--builder-right-panel-width"),$("#vvveb-builder").toggleClass("no-right-panel"),$(".component-properties-tab").toggle(),n.Components.componentPropertiesElement=(e?"#right-panel":"#left-panel #properties")+" .component-properties",$("#properties").is(":visible")&&$(".component-tab a").show().tab("show"),n.Builder.adjustListsHeight()},darkMode:function(){console.log("HI FROM DARK MODE");let e=$("html").attr("data-bs-theme");"dark"==e?(e="light",$(".btn-dark-mode i").removeClass("la-moon").addClass("la-sun")):"light"==e||"auto"==e?(e="dark",$(".btn-dark-mode i").removeClass("la-sun").addClass("la-moon")):e="auto",$("html").attr("data-bs-theme",e),localStorage.setItem("theme",e)}},n.StyleManager={styles:{},cssContainer:!1,mobileWidth:"320px",tabletWidth:"768px",init:function(e){if(e){var t=!1,n=!1;for(let o=0;o<e.styleSheets.length;o++)if((n=e.styleSheets[o]).ownerNode.id&&"vvvebjs-styles"==n.ownerNode.id){t=n;break}if(!t)return this.cssContainer=$('<style id="vvvebjs-styles"></style>'),$(e.head).append(this.cssContainer),this.cssContainer;for(let e=0;e<t.cssRules.length;e++)if(media=void 0===t.cssRules[e].media?"desktop":"screen and (max-width: 1220px)"===t.cssRules[e].media[0]?"tablet":"screen and (max-width: 320px)"===t.cssRules[e].media[0]?"mobile":"desktop",selector="desktop"===media?t.cssRules[e].selectorText:t.cssRules[e].cssRules[0].selectorText,styles="desktop"===media?t.cssRules[e].style:t.cssRules[e].cssRules[0].style,media&&(this.styles[media]=this.styles[media]??{},selector)){this.styles[media][selector]={};for(let e=0;e<styles.length;e++)property=styles[e],value=styles[property],this.styles[media][selector][property]=value}return this.cssContainer=$("#vvvebjs-styles",e)}},getSelectorForElement:function(e){if(!e)return"";for(var t=e,o=[];t.parentElement;){let e="",a=Array.from(t.classList).map((function(e){if(-1==n.Builder.ignoreClasses.indexOf(e))return"."+e})).join("");if(t.id){e="#"+t.id,o.push(e);break}if(a)e=a;else{var i=t.tagName.toLowerCase();("body"!=i||"body"==i&&o.length<=1)&&(e=i)}e&&o.push(e),t=t.parentElement}return o.reverse().join(" > ")},setStyle:function(e,t,n){if("string"==typeof e)selector=e;else{let o=e.get(0);if(o.style&&o.style[t])return o.style[t]=n,e;selector=this.getSelectorForElement(o)}return media=$("#canvas").hasClass("tablet")?"tablet":$("#canvas").hasClass("mobile")?"mobile":"desktop",this.styles[media]||(this.styles[media]={}),this.styles[media][selector]||(this.styles[media][selector]={}),this.styles[media][selector][t]||(this.styles[media][selector][t]={}),this.styles[media][selector][t]=n,this.generateCss(media),e},generateCss:function(e){var t="";for(e in this.styles){for(selector in"tablet"!==e&&"mobile"!==e||(t+=`@media screen and (max-width: ${"tablet"===e?this.tabletWidth:this.mobileWidth}){`),this.styles[e]){for(property in t+=`${selector} {`,this.styles[e][selector])value=this.styles[e][selector][property],t+=`${property}: ${value};`;t+="}"}"tablet"!==e&&"mobile"!==e||(t+="}")}this.cssContainer.html(t)},_getCssStyle:function(e,t){var n,o="";if(e.jquery){if(!e.length)return"";o="",n=e.get(0),selector=this.getSelectorForElement(n)}else if(e.nodeType)n=e,selector=this.getSelectorForElement(n);else{if("string"!=typeof e)return"";if(selector=e,!(e=$(selector)[0]??!1))return""}return media=$("#canvas").hasClass("tablet")?"tablet":$("#canvas").hasClass("mobile")?"mobile":"desktop",n.style&&n.style.length>0&&n.style[t]?o=n.style[t]:void 0!==this.styles[media]&&void 0!==this.styles[media][selector]&&void 0!==this.styles[media][selector][t]?(o=this.styles[media][selector][t],"font-family"==t&&console.log(o)):window.getComputedStyle&&(o=document.defaultView.getDefaultComputedStyle?document.defaultView.getDefaultComputedStyle(n,null).getPropertyValue(t):window.getComputedStyle(n,null).getPropertyValue(t)),o},getStyle:function(e,t){return this._getCssStyle(e,t)}},n.ContentManager={getAttr:function(e,t){return e.attr(t)},setAttr:function(e,t,n){return e.attr(t,n)},setHtml:function(e,t){return e.html(t)},getHtml:function(e){return e.html()},setText:function(e,t){return e.text(t)},getText:function(e){return e.text()}};var l=null,s=null;n.SectionList={selector:".sections-container",allowedComponents:{},init:function(e={}){this.allowedComponents=e,$(this.selector).on("click","> div .controls",(function(e){var o=$(e.currentTarget.parentNode).data("node");o&&(t((()=>n.Builder.frameHtml.animate({scrollTop:$(o).offset().top-$(o).height()/2},500)),300),n.Builder.selectNode(o),n.Builder.loadNodeComponent(o))})).on("dblclick","> div",(function(e){node=$(e.currentTarget).data("node"),node.click()})),$(this.selector).on("click","li[data-component] label ",(function(e){node=$(e.currentTarget.parentNode).data("node"),t((()=>n.Builder.frameHtml.animate({scrollTop:$(node).offset().top-$(node).height()/2},1e3)),300),node.click()})).on("mouseenter","li[data-component] label",(function(e){node=$($(e.currentTarget.parentNode).data("node")),node.css("outline","1px dashed blue")})).on("mouseleave","li[data-component] label",(function(e){node=$($(e.currentTarget.parentNode).data("node")),node.css("outline",""),""==node.attr("style")&&node.removeAttr("style")})),$(this.selector).on("dragstart","> div",this.dragStart),$(this.selector).on("dragover","> div",this.dragOver),$(this.selector).on("dragend","> div",this.dragEnd),$(this.selector).on("click",".delete-btn",(function(e){var t=$(e.currentTarget).parents(".section-item");t.data("node").remove(),t.remove(),e.stopPropagation(),e.preventDefault()})),$(".sections-list").on("mouseenter","li[data-section]",(function(e){var t=$("img",this).attr("src");$(".block-preview img").attr("src",t).show()})).on("mouseleave","li[data-section]",(function(e){$(".block-preview img").attr("src","").hide()}));var o=this;$("#sections .sections-list").on("click"," .add-section-btn",(function(e){var i=n.Sections.get(this.parentNode.dataset.type),a=$(i.html),r=a[0].tagName.toLowerCase(),l=$("> "+r+":last",n.Builder.frameBody);l.length?l.after(a):"nav"==r?(l=$("> nav:first,> header:first",n.Builder.frameBody)).length?l.before(a):$(n.Builder.frameBody).append(a):"footer"!=r&&(l=$("body > footer:last",n.Builder.frameBody)).length?l.before(a):$(n.Builder.frameBody).append(a),n.Builder.frameHtml.animate({scrollTop:$(a).offset().top},1e3),t((()=>a.click()),1e3),a=a.get(0),n.Undo.addMutation({type:"childList",target:a.parentNode,addedNodes:[a],nextSibling:a.nextSibling}),o.loadSections(),e.preventDefault()})),$(this.selector).on("click",".properties-btn",(function(e){$(e.currentTarget).parents(".section-item").data("node").click(),e.preventDefault()}))},getSections:function(){var e=[];return $("> section, > header, > footer, > main, > nav",window.FrameDocument.body).each((function(t,n){var o=n.id?n.id:n.title?n.title:n.className;o||(o="section-"+Math.floor(1e4*Math.random()));var i={name:o.replace(/[^\w+]+/g," "),id:n.id,type:n.tagName.toLowerCase(),node:n};e.push(i)})),e},loadComponents:function(e,t,n={}){var o=[];a(t,o,n);var i=r(o);$("ol",e).replaceWith(i)},addSection:function(e){var t=$(tmpl("vvveb-section",e));t.data("node",e.node),$(this.selector).append(t),this.loadComponents(t,e.node,this.allowedComponents)},loadSections:function(){var e=this.getSections();for(i in $(this.selector).html(""),e)this.addSection(e[i])},dragOver:function(e){e.target!=s&&"section-item"==e.target.className&&(s&&s.classList.remove("drag-over"),(s=e.target).classList.add("drag-over"))},dragEnd:function(e){if(s){var t=l.parentNode,n=$(l).data("node"),o=$(s).data("node");s.offsetTop>l.offsetTop?(t.insertBefore(l,s.nextElementSibling),o.parentNode.insertBefore(n,o.nextElementSibling)):(t.insertBefore(l,s),o.parentNode.insertBefore(n,o)),s.classList.remove("drag-over");var i=n.get(0);self.dragMoveMutation={type:"move",target:i,oldParent:i.parentNode,oldNextSibling:i.nextSibling}}l=null,s=null},dragStart:function(e){l=e.target}},n.FileManager={tree:!1,pages:{},currentPage:!1,allowedComponents:{},init:function(e={}){this.allowedComponents=e,this.tree=$("#filemanager .tree > ol").html(""),$(this.tree).on("click","a",(function(e){return e.preventDefault(),!1})),$(this.tree).on("click",".delete",(function(e){let t=$(e.target).closest("li");return n.FileManager.deletePage(t,e),e.preventDefault(),!1})),$(this.tree).on("click",".rename",(function(e){let t=$(e.target).closest("li");return n.FileManager.renamePage(t,e,!1),e.preventDefault(),!1})),$(this.tree).on("click",".duplicate",(function(e){let t=$(e.target).closest("li");return n.FileManager.renamePage(t,e,!0),e.preventDefault(),!1})),$(this.tree).on("click","li[data-page] label",(function(t){var o=$(this.parentNode).data("page");return o&&n.FileManager.loadPage(o,e),!1})),$(this.tree).on("click","li[data-component] label ",(function(e){node=$(e.currentTarget.parentNode).data("node"),t((()=>n.Builder.frameHtml.animate({scrollTop:$(node).offset().top-$(node).height()/2},500)),500),node.click()})).on("mouseenter","li[data-component] label",(function(e){node=$(e.currentTarget.parentNode).data("node"),t((()=>n.Builder.frameHtml.animate({scrollTop:$(node).offset().top-$(node).height()/2},500)),1e3),$(node).trigger("mousemove")}))},deletePage:function(e,t){let n=e[0].dataset;if(confirm(`Are you sure you want to delete "${n.file}"template?`)){let t;(t=$(window).triggerHandler("vvveb.FileManager.deletePage",n))&&null!=t&&(n=t),n&&($.ajax({type:"POST",url:deleteUrl,data:{file:n.file},success:function(e,t){let n="bg-success";e.success?$("#top-panel .save-btn").attr("disabled","true"):n="bg-danger",o(n,"Delete",e.message??e)},error:function(e){o("bg-danger","Error",e.responseText)}}),e.remove())}},renamePage:function(e,t,i=!1){let a=e[0].dataset,r=prompt(`Enter new file name for "${a.file}"`,a.file),l=this;if(r){let t;(t=$(window).triggerHandler("vvveb.FileManager.renamePage",[a,r]))&&([a,r]=t),a&&$.ajax({type:"POST",url:renameUrl,data:{file:a.file,newfile:r,duplicate:i},success:function(t){let s="bg-success";t.success?$("#top-panel .save-btn").attr("disabled","true"):s="bg-danger",o(s,"Rename",t.message??t);let d=r.replace(".html",""),c=function(e){return(e=e.replaceAll("--bs-","").replaceAll("-"," ").trim())[0].toUpperCase()+e.slice(1)}(r.replace(/.*[\/\\]+/,"")).replace(".html","");if(i){let e=l.pages[a.page];e.file=r,e.title=c,n.FileManager.addPage(d,e)}else l.pages[a.page].file=r,l.pages[a.page].title=c,$("> label span",e).html(c),a.url=a.url.replace(a.file,r),a.file=r,l.pages[a.page].url=a.url,l.pages[a.page].file=a.file},error:function(e){o("bg-danger","Error",e.responseText)}})}},addPage:function(e,t){let n;if((n=$(window).triggerHandler("vvveb.FileManager.addPage",[e,t]))&&([e,t]=n),!e)return!1;this.pages[e]=t,t.name=e;var o=this.tree;t.folder&&((o=this.tree.find('li[data-folder="'+t.folder+'"]')).length||(t.folderTitle=t.folder[0].toUpperCase()+t.folder.slice(1),o=$(tmpl("vvveb-filemanager-folder",t)),this.tree.append(o)),o=o.find("> ol")),o.append(tmpl("vvveb-filemanager-page",t))},addPages:function(e){for(page in e)this.addPage(e[page].name,e[page])},addComponent:function(e,t,n,o){$("[data-page='"+o+"'] > ol",this.tree).append(tmpl("vvveb-filemanager-component",{name:e,url:t,title:n}))},loadComponents:function(e={}){var t=[];a(window.FrameDocument.body,t,e);var n=r(t);$("[data-page='"+this.currentPage+"'] > ol",this.tree).replaceWith(n)},getCurrentUrl:function(){if(this.currentPage)return this.pages[this.currentPage].url},getCurrentPage:function(){return this.currentPage},getPageData:function(e){if(this.currentPage)return this.pages[this.currentPage][e]},getCurrentFileName:function(){if(this.currentPage){var e=this.pages[this.currentPage].folder;return(e=e?e+"/":"")+this.pages[this.currentPage].file}},reloadCurrentPage:function(){if(this.currentPage)return this.loadPage(this.currentPage)},loadPage:function(e,t=!1,o=!0,i=!1){let a=this.pages[e].url??"";if(!a)return;let r,l=$("[data-page='"+e+"']",this.tree);$("[data-page]",this.tree).removeClass("active"),l.addClass("active"),$("> input[type=checkbox]",$(l).parents("[data-folder]")).prop("checked",!0),this.currentPage=e,$(".btn-preview-url").attr("href",a),(r=$(window).triggerHandler("vvveb.FileManager.loadPage",[e,a,this.pages[e]]))&&([e,a,this.pages[e]]=r),a&&n.Builder.loadUrl(a+(o?(a.indexOf("?")>-1?"&r=":"?r=")+Math.random():""),(function(){i&&n.FileManager.loadComponents(t),n.SectionList.loadSections(t),n.StyleManager.init()}))},scrollBottom:function(){var e=this.tree.parent();e.scrollTop(e.prop("scrollHeight"))}},n.Breadcrumb={tree:!1,init:function(){this.tree=$(".breadcrumb-navigator > .breadcrumb").html(""),$(this.tree).on("click",".breadcrumb-item",(function(e){let o=$(this).data("node");o&&(o.click(),t((()=>n.Builder.frameHtml.animate({scrollTop:$(o).offset().top-$(o).height()/2},500)),100)),$(window).triggerHandler("vvveb.Breadcrumb.click",o),e.preventDefault()})).on("mouseenter",".breadcrumb-item",(function(e){let t=$($(this).data("node"));t.get(0).dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0})),$(window).triggerHandler("vvveb.Breadcrumb.hover",t)}))},addElement:function(e,t){var n=$(tmpl("vvveb-breadcrumb-navigaton-item",e));n.data("node",t),$(this.tree).prepend(n)},loadBreadcrumb:function(e){this.tree.html("");for(var t=e;t.parentElement;){let e=n.Builder._getElementType(t),o=e[1].toLowerCase();this.addElement({name:o+" "+e[0],className:"el-"+o},t),t=t.parentElement}}},n.FontsManager={activeFonts:[],providers:{},addProvider:function(e,t){this.providers[e]=t},addFont:function(e,t,n=!1){if(!e)return;let o=this.providers[e];o&&(o.addFont(t),this.activeFonts.push({provider:e,fontFamily:t,element:n}))},removeFont:function(e,t){let n=this.providers[e];"default"!=e&&n&&n.removeFont(t)},cleanUnusedFonts:function(){for(i in this.activeFonts){let e=this.activeFonts[i];e.element&&n.StyleManager.getStyle(e.element,"font-family").replaceAll('"',"")!=e.fontFamily&&this.removeFont(e.provider,e.fontFamily)}}},n.ColorPaletteManager={getAllCSSVariableNames:function(e=document.styleSheets,t){let n={font:{},color:{},dimensions:{}};for(var o=0;o<e.length;o++)try{let r=e[o].cssRules;for(var i=0;i<r.length;i++)try{let e=r[i].style;if(t&&r[i].selectorText&&r[i].selectorText!=t)continue;for(var a=0;a<e.length;a++){let t=e[a],o=e.getPropertyValue(t).trim(),i="";if(t.startsWith("--")){if(t.endsWith("-rgb"))continue;if(o.startsWith("var("))continue;let e=t.replace("--bs-","").replaceAll("-"," ");o.startsWith("#")?i="color":o.indexOf('"')>=0||o.indexOf("'")>=0?i="font":o.endsWith("em")>0||o.endsWith("px")>0?i="dimensions":isNaN(parseFloat(o))||(i="dimensions"),i&&(n[i]||(n[i]={}),n[i][t]={value:o,type:i,friendlyName:e})}}}catch(e){}}catch(e){}return n},getCssWithVars:function(e=document.styleSheets,t){let n={},o="",i="";for(var a=0;a<e.length;a++)try{let s=e[a].cssRules;for(var r=0;r<s.length;r++)try{let e=s[r].style;i="";for(var l=0;l<e.length;l++){let o=e[l],a=e.getPropertyValue(o);if(o.startsWith("--bs-btn-"))for(v in t)a==t[v]&&(n[o]=v,i+=o+":var("+v+");\n")}i&&(o+=s[r].selectorText+"{\n",o+=i,o+="}\n")}catch(e){}}catch(e){}return n},init:function(e){n.Builder.selectedEl=$(e.body),n.Components.render("config/bootstrap","#configuration .component-properties")}}})();